# CLI 設定ファイル

このファイルは、Claude Code および Gemini CLI がこのプロジェクトのコードを理解し、変更するためのガイドラインを定義します。

## 1. プロジェクト概要

このリポジトリは、DooD(Docker out of Docker)を用いて、複数のサブプロジェクトを単一の場所で管理しています。
中央の `main` 開発コンテナを管理ハブとして、各サブプロジェクトの開発、ビルド、実行を制御します。

## 2. ディレクトリ構成と技術スタック

- **/main**:
  - **役割**: プロジェクト全体の管理ハブとなる開発コンテナ。
  - **技術スタック**: Gemini CLI, Docker CLI, Docker Compose
  - **説明**: このコンテナから、他のすべてのサブプロジェクトのコンテナを操作します。

- **/subproject1**:
  - **役割**: Node.jsアプリケーション用のプロジェクト。
  - **技術スタック**: Node.js

- **/subproject2**:
  - **役割**: Pythonアプリケーション用のプロジェクト。
  - **技術スタック**: Python

## 3. 開発ワークフローと主要コマンド

### サブプロジェクトのシェル起動方法

`main`コンテナから、開発したいサブプロジェクトを起動します。
開発エージェント（Gemini, Claudeなど）に指示を出すと、`main`コンテナのCLIから、以下のコマンドで各サブプロジェクトのコンテナ内シェルを起動できます。

- **`subproject1`を起動する場合:**
  ```bash
  docker compose -f subproject1/docker-compose.yml run --rm app bash
  ```

- **`subproject2`を起動する場合:**
  ```bash
　docker compose -f subproject2/docker-compose.yml run --rm app bash
  ```

### サブプロジェクト内でのコマンド実行

`main`コンテナから各サブプロジェクトのコンテナ内でコマンドを実行するには、`docker compose run` を使用します。

- **依存関係のインストール (`subproject1`の例):**
  ```bash
  docker compose -f subproject1/docker-compose.yml run --rm app npm install
  ```

- **アプリケーションの実行 (`subproject2`の例):**
  ```bash
  docker compose -f subproject2/docker-compose.yml run --rm app python hello.py
  ```

### 起動時のルール

- **起動後は、まず `main/memory.md` を読み込み、前回の作業内容と現在の状態を把握すること。**

## 4. コーディング規約とルール

- **全般:** 各サブプロジェクト固有のルールは、それぞれのディレクトリ内で定義します。
- **作業記録のルール:**
  1.  **目的:** 将来の自分や他の開発者が文脈を理解しやすくするため、作業記録を`main/memory.md`に蓄積します。
  2.  **記録のタイミング:** ファイルの変更、重要な決定、問題解決など、作業の区切りで行います。
  3.  **記録の内容:**
      - **会話の要約:** その作業に至った背景や目的がわかるように、直前の会話の要約を記載します。
      - **変更点:** 具体的な変更内容（どのファイルをどう変更したか）をリストアップします。
      - **次のステップ:** 次に行うべきアクション（例: コンテナのリビルド、テストの実行など）を明記します。
  4.  **リビルド時の徹底:** 特にDev Containerの構成変更などで**リビルドが必要な場合**は、上記の手順で`memory.md`に記録した後、ユーザーにリビルドを依頼することを徹底します。
  5.  **セッション終了時:** 作業を終了する際は、`Ctrl+C`を押す前に `/save` と入力してください。これをトリガーとして、Geminiがそのセッションの会話全体を要約し、`memory.md`に追記します。


## 5. 作業記録
- **作業記録:** プロジェクトに関する作業記録やコンテキストは、`/main/memory.md`に記録しています。定期的にそれまでの作業内容を要約して記録してください。


## 6. その他

- **APIキー:** `.env`ファイルに記載されているAPIキーや秘密情報を、コードに直接ハードコーディングしないでください。各プロジェクトの `.env.example` を参考に、適切な `.env` ファイルを作成してください。
